<?xml version="1.0" ?>

<Node name="root" gravity="0 -9.81 0" dt="0.01">
    <RequiredPlugin name="Sofa.Component.IO.Mesh"/> <!-- MeshGmshLoader -->
    <RequiredPlugin name="Sofa.Component.ODESolver.Backward"/> <!-- EulerImplicitSolver -->
    <RequiredPlugin name="Sofa.Component.LinearSolver.Iterative"/> <!-- CGLinearSolver -->
    <RequiredPlugin name="Sofa.Component.Topology.Container.Dynamic"/> <!-- TetrahedronSetTopologyContainer -->
    <RequiredPlugin name="MultiThreading"/> <!-- TetrahedronSetGeometryAlgorithms -->
    <RequiredPlugin name="Sofa.Component.StateContainer"/> <!-- MechanicalObject -->
    <RequiredPlugin name="Sofa.Component.SolidMechanics.FEM.Elastic"/> <!-- ParallelTetrahedronFEMForceField -->
    <RequiredPlugin name="Sofa.Component.Mass"/> <!-- UniformMass -->
    <RequiredPlugin name="Sofa.Component.MechanicalLoad"/> <!-- ConstantForceField -->
    <RequiredPlugin name="Sofa.Component.SceneUtility"/> <!-- InfoComponent (if needed for debugging) -->
    <RequiredPlugin name="Sofa.Component.Visual"/> <!-- Needed to use components [VisualStyle] -->  


    <!-- Load Gmsh .msh volume mesh -->
    <MeshGmshLoader name="meshLoader" filename="brain.msh" rotation="0 0 -90"/>
    <DefaultAnimationLoop name="defaultAnimationLoop" />
    <DefaultVisualManagerLoop name="defaultVisualManagerLoop" />


    <Node name="WhiteMatter">
        <!-- Solvers -->
        <EulerImplicitSolver rayleighStiffness="0.1" rayleighMass="0.1" />
        <CGLinearSolver iterations="200" tolerance="1e-9" threshold="1e-9" />

        <!-- Topology + geometry -->
        <TetrahedronSetTopologyContainer name="topo" src="@../meshLoader" />
        <TetrahedronSetGeometryAlgorithms template="Vec3d" name="GeomAlgo" />
        <MechanicalObject template="Vec3d" name="MechanicalModel" showObject="1" />

        <!--Material -->
        <ParallelTetrahedronFEMForceField name="FEM" youngModulus="10000" poissonRatio="0.4" />

        <!-- Mass and external force -->
        <UniformMass name="mass" totalMass="10" />
        <ConstantForceField totalForce="0 -1 0" />
    </Node>

</Node>
